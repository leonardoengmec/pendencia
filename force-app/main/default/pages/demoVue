<apex:page standardStylesheets="false" showHeader="false" sidebar="false">
<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="https://unpkg.com/vue-router/dist/vue-router.js"></script>

<script src="https://cdnjs.cloudflare.com/ajax/libs/vue-resource/1.5.1/vue-resource.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.js"></script>

<link href='https://fonts.googleapis.com/css?family=Roboto:100,300,400,500,700,900|Material+Icons' rel="stylesheet" />
<link href="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.min.css" rel="stylesheet" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no, minimal-ui" />

<html xmlns:v-bind="http://vue.org" xmlns:v-on="http://vue.org">
<body>
    <div id="my_view1">
        <v-app>
            <v-content>
                <v-container>
                    <v-btn color="info" onClick="app.listarPedidos();">Listar</v-btn>
                    <v-btn color="info" onClick="app.listarPedidos();">Despesa</v-btn>

                    <v-data-table v-bind:items="listaPedidos" class="elevation-1">
                        <template slot="headers" slot-scope="props">
                            <tr class="text-xs-left">
                                <th>Codigo</th>
                                <th>CodigoExterno</th>
                                <th>Previsão de entrega</th>
                                <th>Valor</th>
                                <th>Status</th>
                            </tr>
                        </template>
                        <template slot="items" slot-scope="props">
                            <td>{{ props.item.Codigo }}</td>
                            <td>{{ props.item.CodigoExterno }}</td>
                            <td>{{ props.item.DataPrevisaoEntregaInicial }}</td>
                            <td>{{ props.item.FormasPagamento }}</td>
                            <td>{{ props.item.Status.Descricao }}</td>
                        </template>
                    </v-data-table>

                </v-container>
            </v-content>
        </v-app>

    </div>

    <div id="my_view2">
        <v-app>
            <v-content>
                <v-container>
                    <v-btn color="info" onClick="app.listarPedidos();">Listar</v-btn>
                    <v-btn color="info" onClick="app.listarPedidos();">Despesa</v-btn>

                    <v-data-table v-bind:items="listaPedidos" class="elevation-1">
                        <template slot="headers" slot-scope="props">
                            <tr class="text-xs-left">
                                <th>Codigo</th>
                                <th>CodigoExterno</th>
                                <th>Previsão de entrega</th>
                                <th>Valor</th>
                                <th>Status</th>
                            </tr>
                        </template>
                        <template slot="items" slot-scope="props">
                            <td>{{ props.item.Codigo }}</td>
                            <td>{{ props.item.CodigoExterno }}</td>
                            <td>{{ props.item.DataPrevisaoEntregaInicial }}</td>
                            <td>{{ props.item.FormasPagamento }}</td>
                            <td>{{ props.item.Status.Descricao }}</td>
                        </template>
                    </v-data-table>

                </v-container>
            </v-content>
        </v-app>

    </div>

    <script src="https://www.gstatic.com/firebasejs/5.5.8/firebase.js"></script>
    <script>
        // Initialize Firebase
        var config = {
            apiKey: "AIzaSyAdvuUzIfE5HEzGQoYTLqvcejLAWwC_Uzs",
            authDomain: "finance-app-dd52a.firebaseapp.com",
            databaseURL: "https://finance-app-dd52a.firebaseio.com",
            projectId: "finance-app-dd52a",
            storageBucket: "finance-app-dd52a.appspot.com",
            messagingSenderId: "573230168380"
        };
        firebase.initializeApp(config);
    </script>

    <script>

        var db = firebase.database();
        console.log(db);

        var app = new Vue({
            el: '#my_view1',
            data: {
                accessToken: '',
                listaPedidos: []
            },
            methods: {
                autenticacao: function () {
                    console.log('Função autenticação');
                    // GET request
                    this.$http.get('http://api.connectparts.com.br:8032/OAuth/Token',
                        { params: { username: 'leonardosantos', password: 'Connect%402018' } }).then(response => {
                            //console.log(response.body.access_token);
                            //this.$set('accessToken', response.body.access_token);
                            this.accessToken = response.body.access_token;
                        }, response => {
                            console.log('Erro: ' + response);
                        });
                },

                listarPedidos: function () {
                    //'bearer ' + this.accessToken
                    let headers = 'bearer 5WB0vdtD4lUOJi310N4hE09m8KKOyKQ0JogfuUJENZ1K2absqFbxeY0_6pdIxmL6K2HrdEjfy7e0uq7YEs8cROyZlXp4fjPDCWxD18BbpnG2K2nBIuCL2n4MWHuk800Y-QAU0V7k3ulDELobqN4aGwhIgB5ol-gXfXDrFfJsGIXLk29UCRurtQnEhc_4EBeR4J5mcq-yRAXD-BOvnAIXw4EGYPqa-AP9BVNKX8cbm4Kig-AIWMD4J-Tq2rPbMg_jXsnm1wN9o_9dbTkKVZmh-5UvOio';
                    this.$http.get('http://api.connectparts.com.br:8032/fenix/Pedido/ListarSimples?statusCodigo=8%2C9&limite=10',
                        { headers: { 'Authorization': headers } }).then(response => {
                            //this.$set('listaPedidos', response.body)
                            console.log(response.body);
                            this.listaPedidos = response.body;
                        }, response => {
                            console.log('Erro: ' + response);
                        });
                },

                criarNovaDespesa: function (descricao, tipo, valor){
                    var despesa = {
                        descricao: descricao,
                        tipo: tipo,
                        valor: valor
                    };

                    var novaDespesaKey = firebase.database().ref().child('despesas').push().key;

                    var updates = {};
                    updates['/despesas/' + novaDespesaKey] = despesa;

                    return firebase.database().ref().update(updates);
                }
            },
            created: function () {
                this.autenticacao();
                //this.listarPedidos();
            },
        });

        var app = new Vue({
            el: '#my_view2',
            data: {
                accessToken: '',
                listaPedidos: []
            },
            methods: {
                autenticacao: function () {
                    console.log('Função autenticação');
                    // GET request
                    this.$http.get('http://api.connectparts.com.br:8032/OAuth/Token',
                        { params: { username: 'leonardosantos', password: 'Connect%402018' } }).then(response => {
                            //console.log(response.body.access_token);
                            //this.$set('accessToken', response.body.access_token);
                            this.accessToken = response.body.access_token;
                        }, response => {
                            console.log('Erro: ' + response);
                        });
                },

                listarPedidos: function () {
                    //'bearer ' + this.accessToken
                    let headers = 'bearer 5WB0vdtD4lUOJi310N4hE09m8KKOyKQ0JogfuUJENZ1K2absqFbxeY0_6pdIxmL6K2HrdEjfy7e0uq7YEs8cROyZlXp4fjPDCWxD18BbpnG2K2nBIuCL2n4MWHuk800Y-QAU0V7k3ulDELobqN4aGwhIgB5ol-gXfXDrFfJsGIXLk29UCRurtQnEhc_4EBeR4J5mcq-yRAXD-BOvnAIXw4EGYPqa-AP9BVNKX8cbm4Kig-AIWMD4J-Tq2rPbMg_jXsnm1wN9o_9dbTkKVZmh-5UvOio';
                    this.$http.get('http://api.connectparts.com.br:8032/fenix/Pedido/ListarSimples?statusCodigo=8%2C9&limite=10',
                        { headers: { 'Authorization': headers } }).then(response => {
                            //this.$set('listaPedidos', response.body)
                            console.log(response.body);
                            this.listaPedidos = response.body;
                        }, response => {
                            console.log('Erro: ' + response);
                        });
                },

                criarNovaDespesa: function (descricao, tipo, valor){
                    var despesa = {
                        descricao: descricao,
                        tipo: tipo,
                        valor: valor
                    };

                    var novaDespesaKey = firebase.database().ref().child('despesas').push().key;

                    var updates = {};
                    updates['/despesas/' + novaDespesaKey] = despesa;

                    return firebase.database().ref().update(updates);
                }
            },
            created: function () {
                this.autenticacao();
                //this.listarPedidos();
            },
        });
    </script>
</body>
</html>
</apex:page>
